<!DOCTYPE html>
<html>

<head>

    <script src="https://alexzhangmaker.github.io/Brambling/jsResource/mousetrap.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.5/dist/js.cookie.min.js"></script>
</head>
<body>

<h1>My First Heading</h1>

<p>My first paragraph.</p>
    <button id="idBTNLoadJSON">json Github</button>
    <button id="idBTNCallXQ">json XQ</button>

</body>
<script>
    // single keys
    Mousetrap.bind('4', async function(){ 
        console.log('4'); 
        await fetchJSON() ;
    });
    Mousetrap.bind("?", function() { console.log('show shortcuts!'); });
    Mousetrap.bind('esc', function() { console.log('escape'); }, 'keyup');

    // combinations
    Mousetrap.bind('command+shift+k', function() { console.log('command shift k'); });

    // map multiple combinations to the same callback
    Mousetrap.bind(['command+k', 'ctrl+k'], function() {
        console.log('command k or control k');

        // return false to prevent default browser behavior
        // and stop event from bubbling
        return false;
    });

    // gmail style sequences
    Mousetrap.bind('g i', function() { console.log('go to inbox'); });
    Mousetrap.bind('* a', function() { console.log('select all'); });

    // konami code!
    Mousetrap.bind('up up down down left right left right b a enter', function() {
        console.log('konami code');
    });
</script>
<script>
    document.querySelector('#idBTNLoadJSON').addEventListener('click',async (event)=>{
        await fetchJSON() ;
    }) ;

    document.querySelector('#idBTNCallXQ').addEventListener('click',async (event)=>{
        await larkXQQuoto('SH600100') ;
    }) ;
</script>
<script>


    //https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch

    async function fetchJSON(){
        let jsonURL = 'https://alexzhangmaker.github.io/Brambling/json/demo.json' ;
        const response = await fetch(jsonURL);
        let jsonResp = await response.json() ;
        console.log(jsonResp) ;
    }
    
</script>
<script>
    //https://stackoverflow.com/questions/43262121/trying-to-use-fetch-and-pass-in-mode-no-cors
    async function larkXQQuoto(ticker){
        
        let cURLQuoto = `https://stock.xueqiu.com/v5/stock/realtime/quotec.json?symbol=${ticker}` ;
        console.log(cURLQuoto) ;
        var response = await fetch(cURLQuoto,{mode: 'cors'});
        var json = response.getContentText();
        var jsonData = JSON.parse(json);
        Logger.log(jsonData);
        return jsonData.data[0].current ;
    }
</script>
</html>

